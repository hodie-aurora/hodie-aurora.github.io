---
layout:     post   				# 使用的布局（不需要改）
title:      Kubemate CICD 集成 GitOps 应用交付中心            		# 标题 
subtitle:   Kubemate CICD 集成 GitOps 应用交付中心				#副标题
date:       2025-06-03				# 时间
author:     zhaohaiwen 				# 作者
header-img: img/post-bg-2025-01-07.jpg		#这篇文章标题背景图片
catalog: true 					# 是否归档
tags:						#标签
    - Kubemate
---
#### CI/CD 流水线 -> 升级为：集成 GitOps 的应用交付中心

如果让我来改进，我认为我会改写CICD这个模块，因为目前我们采用的CICD是使用jenkins和tekton，但是无论jenkins和tekton都是传统的CICD流水线，它是一种“推模式”流水线，即CICD系统获得权限，将相应配置推送到k8s集群，这可能导致一些问题，比如传统的CICD过程是，从代码仓库拉取代码、打包、并且推送到镜像仓库，再根据保存的yaml对应用进行覆盖部署。但是如果我在CICD流程之前修改了目前部署应用的配置，这就会导致在覆盖部署过程中配置被覆盖，从而导致配置漂移，这是一种推模式。我认为gitops是更好的选择，比如argo CD，它是一种拉模式，当CD发生时它会比较当前的配置与存储的配置是否相同，如果不同可以自动同步或手动同步配置，避免配置漂移。

并且传统CICD流水线回滚复杂，需要重新运行旧的流水线，而gitops可以根据给git历史进行回滚，方面快捷并且方便审计

我的改进方案：CI流程不变，CD流程使用Argo CD

* **CI 流程（Tekton/Jenkins）** ：保持不变，负责构建镜像、运行测试，但 **不再直接部署到生产环境** 。它的最终产物是：1）一个新的容器镜像；2）更新一个专门用于部署的 Git 仓库中的 YAML 文件（例如，更新镜像版本号）。
* **CD 流程（Argo CD/Flux）** ：GitOps 控制器检测到部署仓库的变化后，会自动“拉取（Pull）”这个变更，并应用到集群中，完成部署。

对应的kubemate页面是：

* 提供一个  **GitOps 应用仪表盘** ，内嵌 Argo CD 的管理界面，用户可以直观地看到每个应用的版本、同步状态、健康状况以及与 Git 仓库的差异。
* 简化应用的部署和回滚操作，用户只需在 Git 上提交或回退一个 commit，所有操作都有清晰的 Git 记录。

这样不仅可以避免配置漂移，还方便回滚，并且CI不再需要高权限提高安全性
